
df_test<-df_test %>% 
  group_by(USUBJID) %>%
  mutate(
    Time= ifelse(
      PROGRESSION == 1 , ADY[row_number()]+90, 0
    )
  )

df_test<-df_test %>% 
  group_by(USUBJID) %>%
  mutate(
    Time_minimum= ifelse(
      PROGRESSION == 1 & ADY[]>=Time[row_number()], ADY[] , 0
    )
  )
